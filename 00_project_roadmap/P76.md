# P76: Event Stream Endpoint

## 1. Objective

**What**: Create SSE endpoint for real-time event streaming. Admin UI can subscribe to watch events as they happen.

**Why**: Real-time debugging requires live event feed. SSE is simpler than WebSockets for one-way streaming.

**Scope**:
- Included: SSE endpoint, event filtering, connection management
- Excluded: Dashboard UI components, historical event replay

**Depends on**: P75 (event emission)

## 2. Implementation Tasks

- [ ] EventStreamService (2 files, ~100 LOC)
  - Tests: tests/unit/test_event_stream_service.py
  - Files: services/event_stream_service.py, services/__init__.py
  - Methods: subscribe(), unsubscribe(), publish(), get_subscribers()
  - In-memory pub/sub for simplicity (Redis upgrade path later)

- [ ] SSE endpoint (2 files, ~80 LOC)
  - Tests: tests/integration/test_event_stream_endpoint.py
  - Files: api/routers/observability.py, api/routers/__init__.py
  - Depends on: P76.1
  - GET /observability/events/stream
  - Query params: event_type (filter), since (timestamp)

- [ ] EventEmitter stream integration (1 file, ~30 LOC)
  - Tests: tests/integration/test_event_stream_publish.py
  - Files: services/event_emitter.py
  - Depends on: P76.1, P75
  - Publish to EventStreamService when emitting events

- [ ] Connection timeout handling (1 file, ~40 LOC)
  - Tests: tests/unit/test_event_stream_timeout.py
  - Files: services/event_stream_service.py
  - Depends on: P76.1
  - Heartbeat every 30s, timeout after 5min idle

## 3. Success Criteria

- [ ] GET /observability/events/stream returns SSE format
- [ ] Events stream in real-time as chat messages process
- [ ] event_type filter works correctly
- [ ] Connection handles heartbeat/keepalive
- [ ] Connection closes gracefully on client disconnect
- [ ] Auth required (API key header)
- [ ] All integration tests pass
