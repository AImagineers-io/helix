# P49b: Chat Widget - UI Components

## 1. Objective

**What**: Build the visual components: chat bubble (minimized state), chat window (expanded state), message list, input field, and send button.

**Why**: Framework-agnostic components that work without React on the host page. Lightweight, styled via CSS-in-JS, full control over behavior and appearance.

**Scope**:
- Included: Chat bubble, chat window, message components, input area, typing indicator
- Excluded: Branding integration (P49c), API communication (P49c), persistence (P49d)

**Dependencies**: P49a (widget core, scoped styles)

---

## 2. Implementation Tasks

### Task 49b.1: Create Chat Bubble Component

- [ ] Floating action button to open/close chat (2 files, ~80 LOC)
  - **Tests**: `frontend/tests/widget/components/ChatBubble.test.ts`
    - `test_bubble_renders_in_configured_position()` - bottom-right default
    - `test_bubble_click_toggles_window()` - open/close state
    - `test_bubble_shows_unread_badge()` - notification indicator
    - `test_bubble_keyboard_accessible()` - Enter/Space triggers
    - `test_bubble_has_aria_label()` - accessibility
  - **Files**:
    - `frontend/src/widget/components/ChatBubble.ts`
    - `frontend/src/widget/styles/bubble.ts`

### Task 49b.2: Create Chat Window Component

- [ ] Expandable chat container with header and body (3 files, ~150 LOC)
  - **Tests**: `frontend/tests/widget/components/ChatWindow.test.ts`
    - `test_window_opens_with_animation()` - slide-up transition
    - `test_window_close_button_works()` - minimize to bubble
    - `test_window_header_shows_title()` - placeholder for bot name
    - `test_window_responsive_on_mobile()` - full-screen on small viewports
    - `test_window_traps_focus()` - focus management
  - **Files**:
    - `frontend/src/widget/components/ChatWindow.ts`
    - `frontend/src/widget/components/WindowHeader.ts`
    - `frontend/src/widget/styles/window.ts`

### Task 49b.3: Create Message List Component

- [ ] Scrollable message container with auto-scroll (2 files, ~100 LOC)
  - **Tests**: `frontend/tests/widget/components/MessageList.test.ts`
    - `test_messages_render_in_order()` - chronological display
    - `test_user_messages_align_right()` - visual distinction
    - `test_bot_messages_align_left()` - visual distinction
    - `test_auto_scrolls_on_new_message()` - UX behavior
    - `test_preserves_scroll_when_reading()` - doesn't interrupt user
  - **Files**:
    - `frontend/src/widget/components/MessageList.ts`
    - `frontend/src/widget/components/MessageBubble.ts`

### Task 49b.4: Create Input Area Component

- [ ] Text input with send button (2 files, ~90 LOC)
  - **Tests**: `frontend/tests/widget/components/InputArea.test.ts`
    - `test_input_accepts_text()` - basic functionality
    - `test_send_button_disabled_when_empty()` - validation
    - `test_enter_key_sends_message()` - keyboard shortcut
    - `test_shift_enter_creates_newline()` - multiline support
    - `test_input_cleared_after_send()` - UX behavior
    - `test_input_has_placeholder()` - configurable placeholder
  - **Files**:
    - `frontend/src/widget/components/InputArea.ts`
    - `frontend/src/widget/styles/input.ts`

### Task 49b.5: Create Typing Indicator Component

- [ ] Animated dots shown while waiting for response (1 file, ~40 LOC)
  - **Tests**: `frontend/tests/widget/components/TypingIndicator.test.ts`
    - `test_indicator_shows_three_dots()` - animated dots
    - `test_indicator_has_aria_live()` - screen reader announces
    - `test_indicator_hidden_when_not_loading()` - conditional render
  - **Files**:
    - `frontend/src/widget/components/TypingIndicator.ts`

---

## 3. Success Criteria

- [ ] All components render without React dependency
- [ ] Components use scoped CSS (no global conflicts)
- [ ] Keyboard navigation works (Tab, Enter, Escape)
- [ ] ARIA labels present for accessibility
- [ ] Mobile-responsive layout
- [ ] All tests pass: `npm test -- widget/components`
